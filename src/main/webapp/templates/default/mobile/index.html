<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>首页</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<meta name="format-detection" content="telephone=no"/>
<link href="${base}/templates/${config.theme}/mobile/static/css/common.min.css" rel="stylesheet" type="text/css" />
<link href="${base}/templates/${config.theme}/mobile/static/css/index.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="${base}/templates/${config.theme}/mobile/static/css/global.css"/>
<link rel="stylesheet" type="text/css" href="${base}/templates/${config.theme}/mobile/static/css/style.css"/>
<link href="${base}/templates/${config.theme}/mobile/static/css/diancai.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="${base}/templates/${config.theme}/mobile/static/js/jquery.js"></script>
<script type="text/javascript" src="${base}/templates/${config.theme}/mobile/static/js/jquery.cookie.js"></script>
<script type="text/javascript" src="${base}/templates/${config.theme}/mobile/static/js/ajax.js"></script>
<script src="${base}/templates/${config.theme}/mobile/static/js/zepto.min.js" type="text/javascript" charset="utf-8"></script>
<script src="${base}/templates/${config.theme}/mobile/static/js/swipe.js"></script>
<style type="text/css">
	.hotBuy li {position:relative;}
	.pronum {position:absolute;right:0px;bottom:1.5em;}
	.prolist ul {margin-bottom:20px;}
</style>
</head>
<body>
<!--	<header class="header">
		<div class="logo fl"><a href="${base}/"><img src="${base}/templates/${config.theme}/mobile/static/images/logo.png" alt="" /></a></div>
		<div class="head_meun"><a href="${base}/view/help"></a></div>
	</header>-->

	<div class="search" style="position: fixed; top: 0px; left: 0px; width: 100%;z-index: 9999;height: 40px">
		<input  type="search" id="keyword" name="keyword" placeholder="输入关键词搜索" style="background-color: #F5F5F5">
		<a class="btn_search" href="javascript:void(0)" onClick="sysearch()">搜索</a>
	</div>

	<ul class="meunTab">
		<li class="cur"  val="推荐"><a href="javascript:void(0)" onClick="syfenlei()">推荐</a></li>
		[@product_category_root_list ]
		[#list productCategories as productCategorie]
		<li val="${productCategorie.name}"><a href="javascript:void(0)" onClick="syfenlei(${productCategorie_index})">${productCategorie.name}</a></li>
		[/#list]
		[/@product_category_root_list]
	</ul>

	<div class="index_warp" style="display: block">
		<!--scroll-->
		[@ad_position id = 3]
                <div class="pro_slide" id="scroll_img">
		<ul>
		[#list adPosition.enableAds as ad]
		<li><a href="${ad.url}"><img src="${ad.image}"/></a></li>
		[/#list]
		</ul>
		<ol id='scroll_num'>
		[#list adPosition.enableAds as ad]
		<li [#if ad_index==0]class="cur"[/#if]></li>
		[/#list]
		</ol>
		</div>
		<script>
		          var bullets = document.getElementById('scroll_num').getElementsByTagName('li');
		         var slider = Swipe(document.getElementById('scroll_img'), {
		             auto: 3000,
		             continuous: true,
		             callback: function(pos) {
		                 var i = bullets.length;
		                 while (i--) {
		                     bullets[i].className = '';
		                 }
		                 bullets[pos].className = 'cur';
		             }
		         });
		    </script>
          [/@ad_position]


		<div class="hotBuy">
			<h2 id="syCategoryNameId">推荐</h2>
			<ul id="liProductListId">

			</ul>
<!--			<p><a href="javascript:void (0)" onClick="fenlei(0)">点击查看全部商品>></a></p>
			<div style="height: 50px"></div>-->
		</div>
	</div>


	<!-- header start -->
	<footer>
	    <a class="cur" href="${base}/">首页</a>
	    <a href="${base}/member/order/list">订单</a>
	    <a href="${base}/member">我的</a>
	    <a href="${base}/cart/list">
	        <div class="cart">
	            <span></span>
	            <em id="cartQuantity">0</em>
				<div></div>
	        </div>
	    </a>
	</footer>
	<!-- header end -->
	<script>

        var cartItems;

        //热门更新购物车数量
        function hotUpdateQuantity(productId,quantity){
            $.ax("${base}/cart_item/update",
                     {"productId":productId,"quantity":quantity,"type":1}, 'POST',null,'json',
                     function(data){
                         if(data.productQuantity<=0){
                             $("#cartQuantity").html(data.quantity);
                         }else{
                             $("#cartQuantity").html(data.quantity);
                         }
                         loadCart();
                     });
        }
        
        function hotAddProduct(productId){
            hotUpdateQuantity(productId,1);
        }
        

	$(function(){

        syfenlei();
		$(".meunTab li").click(function(){
			$(this).addClass("cur").siblings().removeAttr("class");

			$("#syCategoryNameId").html($(this).attr("val"));

			//console.log($(this).val);
		})
		loadCart();
	})


      // 分类
      function syfenlei(cid) {
          $.ax("${base}/product/productList",
              {"cid":cid}, 'POST',null,'json',
              function(res){
                  $("#liProductListId").empty();
                  	if (res.type == "success") {
                        var resProductList = res.data;

                        var liProduct = "";
                        for ( var i = 0; i <resProductList.length; i++){
                            var resproduct = resProductList[i];
                            liProduct = liProduct + '<li>'
														+ '<a href="' + resproduct.path + '"><img src="' + resproduct.productImages.thumbnail +  '"/></a>'
														+ '<a href="' + resproduct.path + '">' + resproduct.name + '</a>'
														+ '<div class="pronum">'
															+ '<a style="display: none"></a>'
															+ '<a id="hotAddProduct_' + resproduct.id + '" onClick=hotAddProduct("' + resproduct.id + '")></a>'
														+ '</div>'
														+ '<p>'
															+ "<em>" + resproduct.specifications + "</em>"
															+ "<span>￥" + resproduct.price + "</span>"
															+ "<i>￥" + resproduct.marketPrice+ "</i>"
														+ "</p>"
												+ "</li>"
                        }
                        $("#liProductListId").append(liProduct);
					}
              });
      }

      // 搜索
      function sysearch() {

      }

	function loadCart(){
		//ajax
		$.ax("${base}/cart/view",null,'GET',null,'json',
	            function(data){
					$("#cartQuantity").text(data.quantity);
					cartItems = data.cartItems;
	            }
	       );
	}	
	</script>
</body>
</html>
			
	
	
